*************************** INÍCIO COMANDOS SIMPLES *********************************
-- Qual bd estou?              
SELECT DB_NAME();

-- Listar todos os bd
SELECT name FROM sys.databases ORDER BY name;

-- Conecte ao banco nome_do_banco
USE nome_do_banco;

-- Informações completas
EXEC sp_helpdb 'nome_do_banco';

-- pesquisa Top 10 linhas
SELECT TOP 10 * FROM nome_do_banco

--pesquisar todos os elementos da coluna
SELECT DISTINCT nome_da_coluna FROM nome_do_banco ORDER BY nome_da_coluna;

-- Limpar a tabela criada
DROP TABLE #temp_nome;

*************************** FIM COMANDOS SIMPLES *********************************

*************************** INÍCIO COMANDOS ELABORADOS *********************************
-- Criação de e-mails
SELECT TOP 10 *, -- Seleciona as 10 primeiras linhas da consulta, e todas as colunas (*)            
              CASE  -- Inicia um CASE para lógica condicional                  
                  WHEN CATESC='VINCULADA' THEN -- Condição: quando a coluna CATESC for igual a 'VINCULADA' então
                      CONCAT('e', FORMAT(ESCVINC, '000000'), 'a@educacao.sp.gov.br') -- Se acima for verdadeiro: cria um email concatenando String 'e' com o número de ESCVINC em 6 dígitos (preenche com zeros à esquerda se ESCVINC < 6 dígitos) concatena com String 'a@educacao.sp.gov.br'                
                  ELSE -- Se falso:
                      CONCAT('e', FORMAT(CODESC, '000000'), 'a@educacao.sp.gov.br')   -- cria um email concatenando String 'e' com o número de CODESC em 6 dígitos (preenche com zeros à esquerda se CODESC < 6 dígitos) concatena com String 'a@educacao.sp.gov.br'      
              END               
              AS EMAIL -- Nome da nova coluna calculada como 'EMAIL'
FROM dbo.nome_do_esquema -- Especifica a tabela de origem com esquema dbo

-- Criar temporária 
CREATE TABLE #temp_nome AS
SELECT * FROM  nome_do_banco;

-- Criar temporária com valores específicos da coluna de interesse
CREATE TABLE #temp_nome AS
SELECT * 
FROM nome_do_banco 
WHERE NOME_DA_COLUNA IN (
    'dado_pesquisado_01', 
    'dado_pesquisado_02', 
    'dado_pesquisado_03' 
);

-- Criar temporária com as colunas desejadas
SELECT 
    NOMEDE AS URE,
    CODESC AS CODIGO_DA_ESCOLA,
    NOMESC AS ESCOLA,
    TPESC AS TIPO_DA_ESCOLA,
    OBS AS OBSERVACAO,
    MODAL AS MODALIDADE,
    CATESC AS CATEGORIA
INTO #temp_nome
FROM nome_do_banco;

-- Filtra os registros onde a coluna NOME_DA_COLUNA é igual a dado_pesquisado_01
USE nome_do_banco;
WHERE NOME_DA_COLUNA = dado_pesquisado_01

-- pesquisar se a coluna (por exemplo a terceira) tem trechos dos dados de interesse
SELECT NOME_DA_COLUNA01, NOME_DA_COLUNA02,  NOME_DA_COLUNA03, NOME_DA_COLUNA04
FROM nome_do_banco
WHERE NOME_DA_COLUNA03 LIKE '%dado_pesquisado_01%'
   OR NOME_DA_COLUNA03 LIKE '%dado_pesquisado_02%'
   OR NOME_DA_COLUNA03 LIKE '%dado_pesquisado_03%'
   OR NOME_DA_COLUNA03 LIKE '%dado_pesquisado_04%'
ORDER BY NOME_DA_COLUNA01;    


*************************** FIM COMANDOS ELABORADOS *********************************
